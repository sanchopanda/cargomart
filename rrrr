import gspread
from google.oauth2.service_account import Credentials

# Путь к файлу с учетными данными
creds_path = 'C:\\Users\\Даниил\\Desktop\\Logist Pro\\py\\credentials.json'
spreadsheet_name = 'Logist Pro'

# Укажите scopes
scopes = ['https://www.googleapis.com/auth/spreadsheets', 'https://www.googleapis.com/auth/drive']

# Загрузка учетных данных и авторизация
creds = Credentials.from_service_account_file(creds_path, scopes=scopes)
client = gspread.authorize(creds)

# Открытие таблицы
try:
    spreadsheet = client.open(spreadsheet_name)
    worksheet = spreadsheet.sheet1  # Открываем первый лист
    print("Таблица и лист успешно открыты.")
except Exception as e:
    print(f"Ошибка при открытии таблицы или листа: {e}")
    exit()

# Тестовые данные
test_row = ["Test1", "Test2", "Test3", "Test4", "Test5", "Test6", "Test7", "Test8", "Test9"]

# Запись данных в таблицу
try:
    worksheet.append_row(test_row)
    print("Тестовые данные успешно записаны.")
except Exception as e:
    print(f"Ошибка при записи тестовых данных: {e}")
